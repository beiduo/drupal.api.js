var drupalAPIExports = {};
(function(exports) {
var JSON;JSON||(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}();var drupal=drupal||{};drupal.hasStorage="undefined"!=typeof Storage,drupal.hasStorage&="undefined"!=typeof JSON,drupal.useToken=!0,drupal.retrieve=function(a){var b=null;return a&&drupal.hasStorage&&(b=JSON.parse(localStorage.getItem(a)),b&&(new Date).getTime()>b.expires&&(localStorage.removeItem(a),b={})),b},drupal.store=function(a,b,c){c=c||3600,a&&drupal.hasStorage&&(b.expires=1e3*c+(new Date).getTime(),localStorage.setItem(a,JSON.stringify(b)))},drupal.clear=function(a){a&&drupal.hasStorage&&localStorage.removeItem(a)},drupal.api=function(){return{resource:"",cacheId:"",isMobile:jQuery.hasOwnProperty("mobile"),endpoint:function(){return drupal.endpoint||""},baseURL:function(){return"undefined"!=typeof Drupal&&"string"==typeof Drupal.settings.basePath?location.origin+Drupal.settings.basePath:drupal.baseURL?drupal.baseURL+"/":this.endpoint().replace(/\/[^\/]*$/,"/")},getURL:function(a){if(a&&a.uri)return a.uri;var b=this.endpoint();return b+=this.resource?"/"+this.resource:"",b+=a&&a.id?"/"+a.id:""},loading:function(a){this.isMobile&&(a?jQuery("body").addClass("ui-loading"):jQuery("body").removeClass("ui-loading"))},call:function(a,b,c,d,e,f){var g={url:a,dataType:b,type:c,success:function(a){return function(b,c){a.loading(!1),"success"==c?e&&e(b):console.log("Error: "+c)}}(this),error:function(a){return function(b){a.loading(!1),console.log(b.statusText),e&&e(null)}}(this)};d&&(g.data=d),this.loading(!0);var h=function(a){drupal.useToken&&drupal.current_user.token&&(a.beforeSend=function(a){a.setRequestHeader("X-CSRF-Token",drupal.current_user.token)}),jQuery.ajax(a)},i=drupal.useToken&&(f||"POST"==c||"PUT"==c||"DELETE"==c);!drupal.current_user.token&&i?jQuery.get(this.baseURL()+"services/session/token",function(a){drupal.current_user.token=a,h(g)}):h(g)},get:function(a,b,c,d,e){var f=typeof b;"object"===f?(d=c,c=b,b=""):"function"===f&&(d=b,b="");var g=this.getURL(a);if(g+=b?"/"+b:"",g+=".jsonp",g+=c?"?"+decodeURIComponent(jQuery.param(c,!0)):"",e){this.cacheId=g.replace(/[^A-z0-9\-]/g,"");var h=drupal.retrieve(this.cacheId);if(h&&h.url===g)return void d(h.data)}this.call(g,"jsonp","GET",null,function(a){return function(b){e&&drupal.store(a.cacheId,{url:g,data:b}),d(b)}}(this))},execute:function(a,b,c){var d=this.getURL(b)+"/"+a;this.call(d,"json","POST",b,c,!0)},save:function(a,b){var c=a.id?"PUT":"POST";this.call(this.getURL(a),"json",c,a,b,!0)},remove:function(a,b){this.cacheId&&drupal.clear(this.cacheId),this.call(this.getURL(a),"json","DELETE",null,b,!0)}}};var drupal=drupal||{};drupal.entity=function(a,b,c){this.options=jQuery.extend({store:!0,expires:3600},"undefined"==typeof c?{}:c),a&&(this.properties={},this.set(a)),b&&this.load(b)},drupal.entity.index=function(a,b,c,d){d=jQuery.extend({store:!0},d||{}),"function"==typeof b&&(c=b,b={});var e=new a({});e.api.get({},e.getQuery(b),function(b){if(b)for(var e=b.length;e--;)b[e]=new a(b[e],null,d);c&&c(b)},d.store)},drupal.entity.prototype.setProperties=function(a,b){if(a)for(var c in a)this[c]=b[c]||this[c]||a[c],this.properties[c]=c},drupal.entity.prototype.update=function(a,b){a&&this.set(a),b&&b.call(this,this)},drupal.entity.prototype.set=function(a){this.api=this.api||null,this.setProperties({id:"",uri:""},a),this.entityName="entity"},drupal.entity.prototype.get=function(){var a={};if(this.properties)for(var b in this.properties)a[b]=this[b];return a},drupal.entity.prototype.getPOST=function(){var a=this.get();return a.id||delete a.id,a},drupal.entity.prototype.getQuery=function(a){return a||{}},drupal.entity.prototype.load=function(a){this.id||a(null),this.api&&this.api.get(this.get(),{},function(b){return function(c){c||a(null),b.update(c,a)}}(this),this.options.store)},drupal.entity.prototype.save=function(a){this.api&&this.api.save(this.getPOST(),function(b){return function(c){b.update(c,a)}}(this))},drupal.entity.prototype.remove=function(a){this.id&&this.api.remove(this.get(),a)};var drupal=drupal||{};drupal.cookie=function(a,b,c){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(b))||null===b||void 0===b)){if(c=$.extend({},c),(null===b||void 0===b)&&(c.expires=-1),"number"==typeof c.expires){var d=c.expires,e=c.expires=new Date;e.setDate(e.getDate()+d)}return b=String(b),document.cookie=[encodeURIComponent(a),"=",c.raw?b:encodeURIComponent(b),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join("")}c=b||{};for(var f=c.raw?function(a){return a}:decodeURIComponent,g=document.cookie.split("; "),h=null,i=0;g.hasOwnProperty(i);i++)if(h=g[i].split("="),f(h[0])===a)return f(h[1]||"");return null},drupal.system=function(a,b){drupal.entity.call(this,{},a,b)},drupal.system.prototype=new drupal.entity,drupal.system.prototype.constructor=drupal.system,drupal.system.api=jQuery.extend(new drupal.api,{resource:"system"}),drupal.system.prototype.set=function(a){drupal.entity.prototype.set.call(this,a),this.entityName="system",this.api=drupal.system.api,drupal.current_user=new drupal.user(a.user),drupal.current_user.setSession(a.session_name,a.sessid)},drupal.system.prototype.get=function(){return jQuery.extend(drupal.entity.prototype.get.call(this),{user:drupal.current_user.get()})},drupal.system.prototype.load=function(a){var b=this;this.api.execute("connect",null,function(c){b.update(c,a)})},drupal.system.prototype.get_variable=function(a,b,c){this.api.execute("get_variable",{name:a,"default":b},c)},drupal.system.prototype.set_variable=function(a,b,c){this.api.execute("set_variable",{name:a,value:b},c)},drupal.system.prototype.del_variable=function(a,b){this.api.execute("del_variable",{name:a},b)};var drupal=drupal||{};drupal.node=function(a,b,c){drupal.entity.call(this,a,b,c)},drupal.node.prototype=new drupal.entity,drupal.node.prototype.constructor=drupal.node,drupal.node.api=jQuery.extend(new drupal.api,{resource:"node"}),drupal.node.index=function(a,b,c){drupal.entity.index(drupal.node,a,b,c)},drupal.node.prototype.set=function(a){drupal.entity.prototype.set.call(this,a),this.entityName="node",this.api=drupal.node.api,this.id=a.nid||this.id||0,this.body=a.body,this.fields=a.fields,this.setProperties({nid:0,title:"",type:"",status:0,uid:0},a)},drupal.node.prototype.getPOST=function(){var a=drupal.entity.prototype.getPOST.call(this);if(this.body&&(a.body={und:[{value:this.body}]}),this.fields)for(var b in this.fields)a[b]={und:[this.fields[b]]};return a},drupal.node.prototype.getQuery=function(a){return a=drupal.entity.prototype.getQuery.call(this,a),a.type&&(a["parameters[type]"]=a.type,delete a.type),a};var drupal=drupal||{};drupal.current_user={uid:0,name:"",token:""},drupal.user=function(a,b,c){drupal.entity.call(this,a,b,c)},drupal.user.prototype=new drupal.entity,drupal.user.prototype.constructor=drupal.user,drupal.user.api=jQuery.extend(new drupal.api,{resource:"user"}),drupal.user.index=function(a,b,c){drupal.entity.index(drupal.user,a,b,c)},drupal.user.prototype.set=function(a){drupal.entity.prototype.set.call(this,a),this.entityName="user",this.api=drupal.user.api,this.id=a.uid||this.id||0,this.pass=a.pass||this.pass||"",this.token="",this.setProperties({name:"",mail:"",token:"",status:1},a)},drupal.user.prototype.setSession=function(a,b){this.sessid=b,this.id&&a&&(this.session_name=a,drupal.cookie(a,b),drupal.current_user=this)},drupal.user.prototype.login=function(a){var b=this;if(this.api){if(this.name==drupal.current_user.name&&a)return void a.call(this,this);var c=function(){this.api.execute("login",{username:this.name,password:this.pass},function(b){return function(c){c?(b.update(c.user),b.setSession(c.session_name,c.sessid),a&&a.call(b,b)):a&&a.call(b,null)}}(this))};drupal.current_user.name?this.logout(function(){c.call(b)}):c.call(this)}},drupal.user.prototype.register=function(a){this.api&&this.api.execute("register",this.getPOST(),function(b){return function(c){b.update(c,a)}}(this))},drupal.user.prototype.logout=function(a){this.api&&this.api.execute("logout",null,function(){drupal.current_user={uid:0,name:"",token:""},a&&a()})},drupal.user.prototype.getPOST=function(){var a=drupal.entity.prototype.getPOST.call(this);return a.pass=this.pass,a};exports.drupal = drupal;
})(drupalAPIExports);
var drupal = drupalAPIExports.drupal;
